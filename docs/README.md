# SAC 트레이딩 시스템 문서

이 문서는 Soft Actor-Critic(SAC) 강화학습 알고리즘을 기반으로 한 트레이딩 시스템의 전체 구조와 사용법, 구성 요소에 대해 설명합니다. 이 시스템은 자동화된 트레이딩 전략을 수립하고, 이를 학습·검증·실행하기 위한 통합 프레임워크를 제공합니다.

---

## 📐 시스템 아키텍처

### 클래스 다이어그램
시스템 전반의 구조를 시각화한 다이어그램을 통해 주요 모듈 간의 관계와 데이터 흐름을 정의합니다. 각 컴포넌트는 역할이 명확히 구분되며, 단일 책임 원칙을 따릅니다.

### 핵심 컴포넌트

- **SAC 모델**
  - 강화학습 기반의 의사결정 정책을 구현
  - 정책 네트워크(Actor)와 가치 네트워크(Critic)를 활용
  - 확률적 정책을 기반으로 액션을 선택하며, 탐험성과 안정성을 동시에 확보

- **트레이딩 환경**
  - OpenAI Gym 스타일의 환경 구조
  - 가격, 거래량 등의 데이터를 상태(state)로 제공
  - 보상 함수(reward function)를 통해 전략의 수익성과 리스크를 반영

- **대시보드**
  - 웹 기반의 인터페이스를 통해 실시간 정보 제공
  - 모델의 상태, 포트폴리오 현황, 거래 기록 등을 시각화
  - 운영 중인 시스템을 모니터링하고 제어 가능

- **데이터 관리**
  - 시계열 데이터 수집, 저장, 조회, 전처리 등 기능 포함
  - 파일 기반과 데이터베이스 기반(예: TimescaleDB) 선택 가능
  - 대량의 거래 데이터를 효율적으로 처리할 수 있도록 최적화

---

## 🔄 프로세스 플로우

### 모델 학습 프로세스

모델이 과거 데이터를 통해 학습하며 전략을 최적화하는 절차입니다.

1. 환경 및 모델 초기화
2. 에이전트가 상태(state)를 받아 액션(action)을 선택
3. 선택된 액션에 따라 환경이 반응하고 보상 및 다음 상태를 제공
4. 경험 리플레이 버퍼에 이 경험을 저장
5. 일정 간격마다 정책 및 가치 함수 업데이트 수행
6. 로그 기록 및 모델 체크포인트 저장

### 백테스트 프로세스

학습된 모델의 전략을 과거 시장 데이터에 적용하여 검증하는 과정입니다.

1. 백테스트용 데이터 로딩
2. 모델이 시뮬레이션 환경에서 반복적으로 액션 수행
3. 누적 수익률, 손실, 위험 지표 등을 기록
4. 최종 결과 분석 및 시각화
5. 전략의 유효성 평가

### 실시간 트레이딩 프로세스

실제 거래소 데이터에 모델을 적용하여 실거래를 수행하는 과정입니다.

1. 실시간 데이터 수신 (예: WebSocket, API)
2. 현재 상태 계산 및 모델 입력 생성
3. 모델이 선택한 액션에 따라 매수/매도 주문 생성
4. 주문 체결 결과 확인 및 기록
5. 포트폴리오 상태 갱신 및 리스크 관리 수행

---

## 🗃 데이터 관리

### 파일 기반 데이터 관리

- CSV, Parquet 등의 포맷으로 저장
- 단일 머신에서 실험 및 소규모 백테스트에 적합
- 빠른 로딩과 단순한 설정이 장점

### 데이터베이스 기반 데이터 관리

- TimescaleDB (PostgreSQL 확장 모듈)를 사용
- 초 단위 이상의 고빈도 시계열 데이터를 효율적으로 저장
- 대시보드 및 실시간 처리와의 연동이 용이
- 트레이딩 로그, 체결 데이터, 상태 기록 등을 통합 관리

---

## ⚙ 설치 및 실행 가이드

### 요구 사항

- **Python 3.10 이상**  
  최신 문법 및 라이브러리 호환을 위해 Python 3.10 이상을 권장합니다.

- **CUDA 11.8 이상**  
  GPU 가속 학습을 위한 CUDA 버전. PyTorch의 GPU 지원이 활성화됩니다.

- **TimescaleDB (PostgreSQL 12 기반 이상)**  
  시계열 데이터를 저장하고, 분석 쿼리를 빠르게 수행하기 위한 데이터베이스.

- 기타 주요 라이브러리: PyTorch, Pandas, NumPy, SQLAlchemy, Plotly 등

---

## 🔧 고급 주제

### 모델 하이퍼파라미터 튜닝

- **학습률 (Learning Rate)**  
  학습 속도 조절. 너무 높으면 발산, 너무 낮으면 수렴이 느림.

- **보상 함수 설계 (Reward Function)**  
  수익률 중심, 리스크 중심, 거래 횟수 제한 등 다양한 목표를 반영 가능.

- **할인율 (Gamma)**  
  미래 보상에 대한 현재 가치 평가 비율. 장기 전략일수록 높은 감마를 사용.

- **엔트로피 계수 (Alpha)**  
  탐험(exploration) 강도를 조절하는 계수. SAC는 자동 조정 기능도 지원.

### 커스텀 환경 개발

- **새로운 액션 공간 정의**  
  예: 주문 크기, 레버리지 조절, 포지션 크기 등 세분화된 제어 가능

- **관측 공간 확장**  
  기술적 지표, 시장 심리 지표, 다중 자산 가격 등 포함 가능

- **보상 함수 사용자 정의**  
  전략의 목적에 맞는 커스텀 보상 정의 (예: 최대 손실 억제, 거래 비용 포함 등)

### 성능 최적화

- **TimescaleDB 인덱싱**  
  조회 성능을 높이기 위한 인덱스 설정

- **연결 풀링**  
  DB 연결 효율화 및 지연 최소화

- **쿼리 최적화**  
  대용량 데이터 조회 시 필요한 쿼리 구조 개선

- **캐싱 전략**  
  반복적인 요청에 대해 메모리 캐시 활용
---

## 📝 라이센스

이 프로젝트는 **MIT 라이센스** 하에 배포됩니다.  
사용, 복사, 수정, 병합, 배포 등에 자유로우며, 저작권 고지를 유지해야 합니다.  
자세한 내용은 프로젝트의 `LICENSE` 파일을 참고하세요.
